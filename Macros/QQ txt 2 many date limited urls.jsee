#include "common.js"
#include "lists.js"
// 导入公共函数定义

// ------------------------------------------------------------------------------------------------

// 🪴  0  使用场景说明

// 数据输入：从 QQ 群聊中导出的 .txt 格式的数据
// 数据输出：筛选过后得到的满足时间范围的网址文本行
// 个人建议：
// 👉每个月按照上中下旬去查询 QQ 群消息记录，即每月只需要运行这个宏命令文件三次。
// 👉对于百度网盘，本宏命令文件直接删除，需要运行 Text 2 one url.jsee 来单独处理。

// ------------------------------------------------------------------------------------------------

// 🪴  1  筛选需要的参数信息

// QQ 消息和 Telegram 消息在格式上有所不同
// Telegram 中所有对话栏中的文字内容，前面都会有一个 "text":  格式，但是对于 QQ 来说就没有
// 也就是说，对于 QQ 不容易筛选具体所需要的内容，即第一步不可能是筛选操作
// 这会导致对 QQ 的消息需要对源数据文件进行格式处理
// 因此，在执行本宏命令文件之前，最好备份一下数据文件。

Replace_Words("Regex","\\n\\n","\\n");			// 先删除多余的换行
Replace_Words("Regex","\\n(?!2023-)","\\1");	// 假设只有 2023 年的消息，删除除了日期前面的所有换行符
Overlay_Lines("Normal","2023-03-0");			// 提取三月中旬的消息，数据量少的话可以直接覆盖
Overlay_Lines("Normal","https://");				// 再提取某一天的网址，数据量少的话可以直接覆盖

// ------------------------------------------------------------------------------------------------

// 🪴  2  直接将网址从文本行中提取出来，然后覆盖已有的文本

// Extract_URLs_From_Lines();						// 掐头去尾
// 短期内，个人觉得写这个 QQ 的网址黑名单没有什么必要，能够得到的网址数据量相比于 Telegram 来比少两三个数量级

// ------------------------------------------------------------------------------------------------

// 🪴  3  删除中文 & 网址黑名单

Delete_Lines("Regex", "[^\\x00-\\xff]");		// 删除中文，确实可以另存中文，但是感觉不如直接删掉
// Delete_Blacklist_QQ();

// ------------------------------------------------------------------------------------------------

// 🪴  4  删除网址内部的定位信息

Delete_Parameters_And_Anchors();				// 删除网址内部的参数和锚点
Clean_Text();									// 删除重复行，按字母排序

// ------------------------------------------------------------------------------------------------

// 最终直接得到需要的网址列表